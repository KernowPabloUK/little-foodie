{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
    <h2>Food Statistics</h2>
    {% if children|length > 1 %}
        <div class="mb-3">
            <label><strong>Select Child:</strong></label>
            {% for child in children %}
                <label class="mx-2">
                    <input type="radio" name="child" value="{{ child.id }}" {% if child.id == selected_child_id %}checked{% endif %}>
                    {{ child.name }}
                </label>
            {% endfor %}
        </div>
    {% endif %}
        <table class="table table-bordered text-center my-4 satisfaction-table">
        <thead>
            <tr>
                <th>
                    <img src="{% static 'images/satisfaction_images/Niblet_Love.png' %}" alt="Love" height="48">
                </th>
                <th>
                    <img src="{% static 'images/satisfaction_images/Niblet_Like.png' %}" alt="Like" height="48">
                </th>
                <th>
                    <img src="{% static 'images/satisfaction_images/Niblet_Indifferent.png' %}" alt="Indifferent" height="48">
                </th>
                <th>
                    <img src="{% static 'images/satisfaction_images/Niblet_Dislike.png' %}" alt="Dislike" height="48">
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                {% for s in satisfaction_range|slice:"::-1" %}
                <td>
                    {% with found=0 %}
                    {% for label in food_stats.labels %}
                        {% if label.satisfaction == s %}
                            <div class="satisfaction-food">{{ label.name }}</div>
                            {% with found=1 %}{% endwith %}
                        {% endif %}
                    {% endfor %}
                    {% if not found %}
                        <span class="satisfaction-empty">-</span>
                    {% endif %}
                    {% endwith %}
                </td>
                {% endfor %}
            </tr>
        </tbody>
    </table>
    <canvas id="foodStatsChart" width="400" height="200"></canvas>
    <canvas id="foodVolumeChart" width="400" height="200" class="my-4"></canvas>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const foodData = {{ food_stats|safe }};
</script>
<script src="{% static 'javascript/statistics.js' %}"></script>
{% endblock %}